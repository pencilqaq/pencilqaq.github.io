<!doctype html><html lang=zh-CN><head><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta name=description content=" - https://huaii.top/tampermonkey-doc/"><meta name=author content="Jack - https://huaii.top/"><meta name=msvalidate.01 content="B46311949B856F2A7015F366FB3CE878"><title></title>
<link rel=icon type=image/png href=/favicon.ico><link rel=stylesheet href=https://huaii.top/style.min.a54ad0a7d268f150bddd11e9cab6587a5910c86bcc70a76a80ede24abc41a1be.css><script type=text/javascript src=/main.js defer></script></head><body class=active-animate><div id=header><div class=container-header><div id=vars class=container-vars style=display:none>{
"isSingleColumnOfPostList": true,
"hasFoldAllCodeBlocks": false,
"svgColor": "",
"en": false,
"dark": false
}</div><h1 class=title></h1><div class=container-breadcrumb-nav><div class=breadcrumb-nav-bar><div><a href=/>首页</a></div><div><a href=/nav>导航</a></div><div><a href=/search>搜索</a></div><div><a href=/posts>文章</a></div><div><a href=/archive>归档</a></div><div id=light-dark style=cursor:pointer><a><svg t="1656411842215" class="icon" viewBox="0 0 1024 1024" p-id="5086" width="12" height="12"><path d="M1007.492874 384.513055c-8.795694-34.58307-21.189627-67.666874-36.682043-99.05151-2.698679-5.397358-10.894667-3.498287-10.894666 2.598728v.299853c0 32.484098-6.896624 63.868734-19.890263 92.554691-10.694764 23.488501-25.487523 45.077933-43.978471 64.068635-41.779547 42.679107-99.05151 66.967217-158.722299 67.26707-61.869712.299853-119.941284-24.188159-162.920244-68.966238-40.280281-41.979449-62.56937-98.251902-62.269516-156.323473.399804-59.270984 23.588452-114.94373 65.567901-156.823229 19.59041-19.59041 42.179351-35.082826 66.667364-46.077443C672.956643 71.166451 704.041426 64.469729 736.125719 64.469729h1.299364c6.097015.0 8.096037-8.096037 2.598728-10.794715C708.739126 37.982696 675.655322 25.488812 641.172203 16.493216 599.492607 5.598549 555.714038-.098662 510.536154.001289 222.37722.700947-7.41029 237.38508.185992 525.444064c7.096526 271.667008 225.889418 490.559851 497.456474 497.856279 287.559228 7.796183 524.14341-220.891864 525.842579-508.551044.299853-44.977981-5.297407-88.656599-15.992171-130.236244zm-83.15929 301.552378c-22.588942 53.27392-54.873137 101.250434-95.953027 142.330323-41.179841 41.179841-89.056403 73.464036-142.330324 95.953027-55.172991 23.288599-113.744317 35.182777-174.314666 35.182777s-119.141675-11.794226-174.314666-35.182777c-53.27392-22.588942-101.250434-54.873137-142.330323-95.953027-41.179841-41.179841-73.464036-89.056403-95.953027-142.330323-23.38855-55.172991-35.182777-113.844269-35.182777-174.314666S75.749 392.609092 99.137551 337.436101c22.588942-53.27392 54.873137-101.250434 95.953027-142.330323 41.179841-41.179841 89.056403-73.464036 142.330323-95.953027C392.593892 75.7642 451.26517 63.969974 511.735567 63.969974c13.99315.0 27.886348.599706 41.679596 1.89907-64.168586 52.774165-105.148525 132.834972-105.148525 222.491082.0 159.022152 128.836929 287.859081 287.859081 287.859081 89.156354.0 168.817357-40.580134 221.691473-104.149015 1.099462 13.09359 1.699168 26.387082 1.699168 39.680575.0 60.470397-11.794226 119.141675-35.182776 174.314666z" p-id="5087" fill="#6c757d" stroke="grey" stroke-width="5"/></svg></a></div></div></div><div id=toc>📜</div></div></div><div id=content><div class="container-main
container-page"><div class=desc><span><svg t="1656736000388" class="icon" viewBox="0 0 1024 1024" p-id="7409" width="12" height="12"><path d="M524.885333 338.986667l-324.522666 324.48c-17.28 15.274667-27.989333 36.693333-29.696 56.234666v133.76l130.730666.085334c22.784-1.621333 43.989333-12.245333 61.013334-31.701334L685.098667 499.2 524.885333 338.986667zM585.258667 278.656l160.170666 160.213333 102.144-102.144a19.712 19.712.0 000-27.861333l-132.48-132.437333a19.456 19.456.0 00-27.605333.0L585.258667 278.613333zM701.312 85.333333c27.946667.0 54.741333 11.136 74.282667 30.848L907.904 248.490667a105.045333 105.045333.0 010 148.565333L424.874667 879.957333C395.050667 914.304 352.768 935.424 304.426667 938.752H85.333333v-42.666667l.128-179.84c3.626667-44.970667 24.576-86.826667 56.448-114.944l485.12-485.034666a104.789333 104.789333.0 0174.24-30.933334z" p-id="7410" fill="#adb5bd"/></svg>
0001-01-01&nbsp;
</span><span><svg t="1656737270708" class="icon" viewBox="0 0 1024 1024" p-id="23838" width="11" height="11"><path d="M824.264 95.36c0-23.859 25.043-44.16 48.902-44.16s49.714 20.301 49.714 44.16v190.08c0 23.859-19.054 52.868-42.913 52.868h-190.08c-23.859.0-46.696-25.96-46.696-49.819s22.55-46.249 46.409-46.249h82.025C702.344 175.534 610.22 155.853 512 155.853c-206.775.0-360.398 149.372-360.398 356.147S305.225 870.23 512 870.23c206.775.0 357.467-151.455 357.467-358.23.0-23.859 23.634-50.706 53.413-50.706 29.78.0 49.92 26.847 49.92 50.706.0 254.493-206.307 460.8-460.8 460.8s-460.8-206.307-460.8-460.8C51.2 257.507 257.507 51.2 512 51.2c122.4.0 226.684 33.296 312.264 117.369.358.351.358-24.052.0-73.209z" p-id="23839" fill="#adb5bd"/></svg>
2024-10-17&nbsp;&nbsp;&nbsp;
</span><span><svg t="1656737548689" class="icon" viewBox="0 0 1024 1024" p-id="33866" width="12" height="12"><path d="M832.038608 64.662657H192.030028c-70.774903.0-128.089859 57.325793-128.089859 128.03206v446.793671c0 70.7171050000001 57.314956 128.154884 128.089859 128.154884h133.353183a63.940169 63.940169.0 0155.219742 31.576328l76.099638 129.83828c12.358154 21.093031 33.790754 31.626903 55.216129 31.626903s42.832688-10.544709 55.198067-31.619678l76.222461-129.870792a63.940169 63.940169.0 0155.212517-31.551041h133.54103c70.576219.0 127.732228-57.289669 127.732227-127.800865V192.391272c0-70.536482-57.181295-127.728615-127.786414-127.728615zM895.884854 639.842407A63.85347 63.85347.0 01832.092795 703.703103h-133.54103a127.753903 127.753903.0 00-110.349172 63.09847l-76.222461 129.856342a.274545.274545.0 010-.050574h-.032512s-.021675.061411-.032512.061412l-76.1466-129.85273a127.804477 127.804477.0 00-110.385297-63.11292H192.030028A64.207489 64.207489.0 01127.880338 639.488388V192.694717a64.102729 64.102729.0 0164.14969-64.091891h640.00858a63.799284 63.799284.0 0163.846246 63.788446v447.451135z" fill="#adb5bd" p-id="33867"/><path d="M608.154093 288.092004a31.970084 31.970084.0 00-31.970084 31.970085v160.078006L441.53396 300.861976a31.970084 31.970084.0 00-57.531702 19.200113v255.760676a31.970084 31.970084.0 0063.940169.0V415.863969l134.650048 179.274507a31.970084 31.970084.0 0057.531703-19.200113V320.062089a31.970084 31.970084.0 00-31.970085-31.970085z" fill="#adb5bd" p-id="33868"/></svg>
3424 字</span>&nbsp;
<span><svg t="1656737462334" class="icon" viewBox="0 0 1024 1024" p-id="32892" width="12" height="12"><path d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667zm0 810.666666C307.2 885.333333 138.666667 716.8 138.666667 512S307.2 138.666667 512 138.666667 885.333333 307.2 885.333333 512 716.8 885.333333 512 885.333333z" p-id="32893" fill="#adb5bd"/><path d="M695.466667 567.466667 544 497.066667V277.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v238.933334c0 12.8 6.4 23.466667 19.2 29.866666L669.866667 627.2c4.266667 2.133333 8.533333 2.133333 12.8 2.133333 12.8.0 23.466667-6.4 29.866666-19.2 6.4-14.933333.0-34.133333-17.066666-42.666666z" p-id="32894" fill="#adb5bd"/></svg>
7 分钟</span><div class=container-ctgtag><div class=taxonomy><div class=ctg></div><div class=tag></div></div></div></div><div class=toc><div class=page-operation><div><a href=#><img src=/imgs/icons/arrow-up-circle.svg alt></a></div><div></div><div><a href=https://huaii.top/archive/><img src=/imgs/icons/arrow-right-circle.svg alt></a></div></div><nav id=TableOfContents><ul><li><a href=#元数据>元数据</a></li><li><a href=#油猴api>油猴API</a><ul><li><a href=#gm_addstyle>GM_addStyle</a></li><li><a href=#gm_addelement>GM_addElement</a></li><li><a href=#gm_setvalue>GM_setValue</a></li><li><a href=#gm_getvalue>GM_getValue</a></li><li><a href=#gm_listvalues>GM_listValues</a></li><li><a href=#gm_deletevalue>GM_deleteValue</a></li><li><a href=#gm_addvaluechangelistener>GM_addValueChangeListener</a></li><li><a href=#gm_removevaluechangelistener>GM_removeValueChangeListener</a></li><li><a href=#gm_notification>GM_notification</a></li><li><a href=#gm_setclipboard>GM_setClipboard</a></li><li><a href=#gm_registermenucommand>GM_registerMenuCommand</a></li><li><a href=#gm_unregistermenucommand>GM_unregisterMenuCommand</a></li><li><a href=#gm_openintab>GM_openInTab</a></li><li><a href=#gm_download>GM_download</a></li><li><a href=#gm_getresourcetext>GM_getResourceText</a></li><li><a href=#gm_getresourceurl>GM_getResourceURL</a></li><li><a href=#gm_xmlhttprequest>GM_xmlhttpRequest</a></li><li><a href=#gm_info>GM_info</a></li></ul></li><li><a href=#参考资料>参考资料</a></li></ul></nav></div><div class='content content'><h1 id=油猴脚本api中文参考>油猴脚本API中文参考</h1><p>本文整理了大部分Tampermonkey 油猴脚本API的使用方法，并且附上了每个方法的代码示例。除此之外您可以安装<a href=https://github.com/examplecode/user-script-example>油猴脚本API示例脚本</a>在支持用户脚本的浏览器中进行测试。</p><blockquote><p>提示 文档中介绍的API支持及参数以<a href=https://www.xbext.com>X浏览器</a>的内置脚本管理器为准,其他的脚本管理器可能会存在细微的差别。</p></blockquote><h2 id=元数据>元数据</h2><p>元数据通常放置在整个脚本的开头，主要起到对脚本的一些描述，参数设定，声明，包括脚本名称、简介、作者、版本号、运行方式、所依赖的库文件声明等。</p><p>下面是一个脚本的元数据声明的例子。</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#998;font-style:italic>// ==UserScript==
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic>// @name         Say hello
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic>// @namespace    com.example.hello
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic>// @version      0.1
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic>// @description  When you open the site example.com it says &#34;HELLO&#34;
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic>// @author       You
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic>// @match        www.example.com
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic>// ==/UserScript==
</span></span></span></code></pre></div><table><thead><tr><th>元数据标记</th><th>描述</th></tr></thead><tbody><tr><td>@name</td><td>脚本的名称</td></tr><tr><td>@namespace</td><td>脚本的的名字空间，可以是一个唯一标识或则网址</td></tr><tr><td>@description</td><td>脚本的简介，描述脚本的用法及功能等</td></tr><tr><td>@icon</td><td>为脚本定制一个图标，显示在脚本列表以及浏览器扩展菜单中的图标。可以是一个url图标资源或者Base64编码的 Data URI。</td></tr><tr><td>@author</td><td>脚本的作者姓名或昵称</td></tr><tr><td>@version</td><td>当前脚本的版本号</td></tr><tr><td>@match</td><td>定义脚本的作用域，只在匹配的网址或域名才执行脚本，此标记在元数据中可以有多行声明</td></tr><tr><td>@include</td><td>和@match类似，用来描述脚本的作用域，可以在元数据中存在多行声明。</td></tr><tr><td>@exclude</td><td>用于排除一些URL, 即使@match和@incluide已经指定匹配，可以在元数据中存在多行声明。</td></tr><tr><td>@require</td><td>该脚本执行前，需要依赖第三方的库，可以在元数据中存在多行声明</td></tr><tr><td>@resource</td><td>该脚本执行需要依赖的一些资源文件，如css,文本，图片资源等，可以在元数据中存在多行声明</td></tr><tr><td>@run-at</td><td>指定脚本的执行时机，不同的应用场景可能需要不同的执行时机 ,其中@run-at 的取值可以参见下表</td></tr><tr><td>@grant</td><td>在元数据中声明使用那些API函数</td></tr></tbody></table><p>元数据标记@run-at 的取值如下</p><table><thead><tr><th>取值</th><th>描述</th></tr></thead><tbody><tr><td>document-start</td><td>指定脚本在DOM树开始的时候执行，需要脚本尽早执行的时候添加此声明。</td></tr><tr><td>document-end</td><td>指定脚本在DOM数据加载完毕的时候执行</td></tr><tr><td>document-idle</td><td>页面加载完毕的时候执行。当元数据没有@run-at声明时，脚本默认在此时机执行</td></tr><tr><td>main-menu</td><td>X浏览器的扩展声明，表示此脚本不自动执行，用户通过主菜单扩展选项手动执行。</td></tr><tr><td>context-menu</td><td>X浏览器扩展声明,表示此脚本不自动执行，用户通过长按菜单的扩展选项执行</td></tr><tr><td>tool-menu</td><td>X浏览器扩展声明，表示此脚本不自动执行，用户通过页面工具菜单的扩展选项执行</td></tr></tbody></table><h2 id=油猴api>油猴API</h2><h3 id=gm_addstyle>GM_addStyle</h3><h4 id=描述>描述</h4><p>为页面添加样式一段CSS样式。</p><h4 id=语法>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_addStyle (cssString)
</span></span></code></pre></div><h4 id=参数>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>cssString</td><td>字符串</td><td>字符串样式表</td></tr></tbody></table><h4 id=示例>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span> GM.addStyle(<span style=color:#d14>&#39;#note{color: white; background: #3385ff!important;border-bottom: 1px solid #2d7&#39;</span>);
</span></span></code></pre></div><h3 id=gm_addelement>GM_addElement</h3><h4 id=描述-1>描述</h4><p>增加一个页面元素，可以指定父节点，不指定父节点其节点为根元素。</p><h4 id=语法-1>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_addElement(tagName, attributes)
</span></span></code></pre></div><p>或者</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_addElement(parentNode,tagName, attributes)
</span></span></code></pre></div><h4 id=参数-1>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>tagName</td><td>字符串</td><td>元素名称</td></tr><tr><td>attributes</td><td>对象</td><td>属性名称/数值对</td></tr><tr><td>parentNode</td><td>对象</td><td>新建元素的父节点</td></tr></tbody></table><h4 id=示例-1>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span>GM_addElement(<span style=color:#d14>&#39;script&#39;</span>, {
</span></span><span style=display:flex><span>  textContent<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#39;window.foo = &#34;bar&#34;;&#39;</span>
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GM_addElement(<span style=color:#d14>&#39;script&#39;</span>, {
</span></span><span style=display:flex><span>  src<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#39;https://example.com/script.js&#39;</span>,
</span></span><span style=display:flex><span>  type<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#39;text/javascript&#39;</span>
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GM_addElement(<span style=color:#0086b3>document</span>.getElementsByTagName(<span style=color:#d14>&#39;div&#39;</span>)[<span style=color:#099>0</span>], <span style=color:#d14>&#39;img&#39;</span>, {
</span></span><span style=display:flex><span>  src<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#39;https://example.com/image.png&#39;</span>
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GM_addElement(shadowDOM, <span style=color:#d14>&#39;style&#39;</span>, {
</span></span><span style=display:flex><span>  textContent<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#39;div { color: black; };&#39;</span>
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=gm_setvalue>GM_setValue</h3><h4 id=描述-2>描述</h4><p>通过指定的键值保存数据到浏览器本地存储中。</p><h4 id=语法-2>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_setValue(name,value)
</span></span></code></pre></div><h4 id=参数-2>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>name</td><td>字符串</td><td>字符串键值</td></tr><tr><td>value</td><td>任意类型</td><td>可以是整数、字符串、布尔类型、对象等任意数据</td></tr></tbody></table><h4 id=示例-2>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>GM_setValue(<span style=color:#d14>&#34;foo&#34;</span>, <span style=color:#d14>&#34;bar&#34;</span>);
</span></span><span style=display:flex><span>GM_setValue(<span style=color:#d14>&#34;count&#34;</span>, <span style=color:#099>100</span>);
</span></span><span style=display:flex><span>GM_setValue(<span style=color:#d14>&#34;active&#34;</span>, <span style=color:#000;font-weight:700>true</span>);
</span></span><span style=display:flex><span>GM_setValue(<span style=color:#d14>&#34;data&#34;</span>, {
</span></span><span style=display:flex><span>  name<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#39;Andy&#39;</span>,
</span></span><span style=display:flex><span>  age<span style=color:#000;font-weight:700>:</span> <span style=color:#099>18</span>
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=gm_getvalue>GM_getValue</h3><h4 id=描述-3>描述</h4><p>从浏览器的本地存储获取一个值。</p><h4 id=语法-3>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_getValue(name, defaultValue)
</span></span></code></pre></div><h4 id=参数-3>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>name</td><td>字符串</td><td>字符串键值</td></tr><tr><td>defaultValue</td><td>任意类型</td><td>可选项，如果键值从没有被设置过，返回默认值</td></tr></tbody></table><h4 id=返回值>返回值</h4><p>如果键值被设置过，返回当初设置的数据类型。</p><h4 id=示例-3>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>GM_setValue(<span style=color:#d14>&#34;foo&#34;</span>, <span style=color:#d14>&#34;bar&#34;</span>);
</span></span><span style=display:flex><span>GM_setValue(<span style=color:#d14>&#34;count&#34;</span>, <span style=color:#099>100</span>);
</span></span><span style=display:flex><span>GM_setValue(<span style=color:#d14>&#34;active&#34;</span>, <span style=color:#000;font-weight:700>true</span>);
</span></span><span style=display:flex><span>GM_setValue(<span style=color:#d14>&#34;data&#34;</span>, {
</span></span><span style=display:flex><span>  name<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#39;Andy&#39;</span>,
</span></span><span style=display:flex><span>  age<span style=color:#000;font-weight:700>:</span> <span style=color:#099>18</span>
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>var</span> info <span style=color:#000;font-weight:700>=</span> <span style=color:#d14>`foo = </span><span style=color:#d14>${</span>GM_getValue(<span style=color:#d14>&#34;foo&#34;</span>)<span style=color:#d14>}</span><span style=color:#d14>
</span></span></span><span style=display:flex><span><span style=color:#d14>          count = </span><span style=color:#d14>${</span>GM_getValue(<span style=color:#d14>&#34;count&#34;</span>)<span style=color:#d14>}</span><span style=color:#d14>
</span></span></span><span style=display:flex><span><span style=color:#d14>          active = </span><span style=color:#d14>${</span>GM_getValue(<span style=color:#d14>&#34;active&#34;</span>)<span style=color:#d14>}</span><span style=color:#d14>
</span></span></span><span style=display:flex><span><span style=color:#d14>          data.name =  </span><span style=color:#d14>${</span>GM_getValue(<span style=color:#d14>&#34;data&#34;</span>).name<span style=color:#d14>}</span><span style=color:#d14>`</span>;                   
</span></span><span style=display:flex><span>alert(info);
</span></span></code></pre></div><h3 id=gm_listvalues>GM_listValues</h3><h4 id=描述-4>描述</h4><p>返回使用所以GM_setValue 设置的键值列表。</p><h4 id=语法-4>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_listValues()
</span></span></code></pre></div><h4 id=示例-4>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>GM_setValue(<span style=color:#d14>&#34;foo&#34;</span>, <span style=color:#d14>&#34;bar&#34;</span>);
</span></span><span style=display:flex><span>GM_setValue(<span style=color:#d14>&#34;count&#34;</span>, <span style=color:#099>100</span>);
</span></span><span style=display:flex><span>GM_setValue(<span style=color:#d14>&#34;active&#34;</span>, <span style=color:#000;font-weight:700>true</span>);
</span></span><span style=display:flex><span>GM_setValue(<span style=color:#d14>&#34;data&#34;</span>, {
</span></span><span style=display:flex><span>name<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#39;Andy&#39;</span>,
</span></span><span style=display:flex><span>age<span style=color:#000;font-weight:700>:</span> <span style=color:#099>18</span>
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>alert(GM_listValues());
</span></span></code></pre></div><h3 id=gm_deletevalue>GM_deleteValue</h3><h4 id=描述-5>描述</h4><p>删除通过GM_setValue 方法设置的键值。</p><h4 id=语法-5>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_deleteValue(name)
</span></span></code></pre></div><h4 id=参数-4>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>name</td><td>字符串</td><td>字符串键值</td></tr></tbody></table><h4 id=示例-5>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>GM_deleteValue(<span style=color:#d14>&#34;foo&#34;</span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>let</span> keys <span style=color:#000;font-weight:700>=</span>  GM_listValues();
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>for</span> (<span style=color:#000;font-weight:700>let</span> key <span style=color:#000;font-weight:700>of</span> keys) {
</span></span><span style=display:flex><span>  GM_deleteValue(key);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=gm_addvaluechangelistener>GM_addValueChangeListener</h3><h4 id=描述-6>描述</h4><p>用来监听通过GM_setValue设置的键值对的改变</p><h4 id=语法-6>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_addValueChangeListener(name,callback);
</span></span></code></pre></div><h4 id=参数-5>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>name</td><td>字符串</td><td>字符串键值</td></tr><tr><td>callback</td><td>回调函数</td><td>当指定的键值改变时回调此函数</td></tr></tbody></table><h5 id=callback-参数列表>callback 参数列表</h5><ul><li><strong>name</strong> - 字符串类型，键值名称</li><li><strong>oldValue</strong> - 任意类型 ，以前的键值</li><li><strong>newValue</strong> - 任意类型 ，新的键值。</li><li><strong>remote</strong> - 布尔类型，来自当前标签的回调还是垮标签的回调（目前没有实现跨标签回调）</li></ul><h4 id=返回值-1>返回值</h4><p>返回监听的回调函数的id,用于以后通过GM_removeValueChangeListener 方法删除回调函数。</p><h4 id=示例-6>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>   listener_id <span style=color:#000;font-weight:700>=</span> GM_addValueChangeListener(<span style=color:#d14>&#34;foo&#34;</span>,<span style=color:#000;font-weight:700>function</span>(name,old_value,new_value,remote) {
</span></span><span style=display:flex><span>        alert(<span style=color:#d14>&#34;Value Changed:&#34;</span> <span style=color:#000;font-weight:700>+</span> name <span style=color:#000;font-weight:700>+</span> <span style=color:#d14>&#34;:&#34;</span> <span style=color:#000;font-weight:700>+</span> old_value <span style=color:#000;font-weight:700>+</span> <span style=color:#d14>&#34;=&gt;&#34;</span> <span style=color:#000;font-weight:700>+</span> new_value);
</span></span><span style=display:flex><span>    });
</span></span></code></pre></div><h3 id=gm_removevaluechangelistener>GM_removeValueChangeListener</h3><h4 id=描述-7>描述</h4><p>用来删除通过GM_addValueChangeListener添加的监听回调</p><h4 id=语法-7>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_removeValueChangeListener(listener_id);
</span></span></code></pre></div><h4 id=参数-6>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>listener_id</td><td>回调函数Id</td><td>GM_removeValueChangeListener返回的回调函数id</td></tr></tbody></table><h4 id=示例-7>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span> GM_removeValueChangeListener(listener_id);
</span></span></code></pre></div><h3 id=gm_notification>GM_notification</h3><h4 id=描述-8>描述</h4><p>显示一条通知消息</p><h4 id=语法-8>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_notification(details)
</span></span></code></pre></div><p>或者</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_notification(text, title, image, onclick )
</span></span></code></pre></div><h4 id=参数-7>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>details</td><td>对象</td><td>一个包含text字段和ondone,onclick回调函数字段的对象</td></tr><tr><td>text</td><td>字符串</td><td>文本内容</td></tr><tr><td>title</td><td>字符串</td><td>参数为了兼容，手机端目前未实现</td></tr><tr><td>Image</td><td>对象</td><td>参数为了兼容，手机端目前未实现</td></tr><tr><td>onclick</td><td>回调函数</td><td>当用户点击了确定按钮的回调函数</td></tr></tbody></table><h4 id=示例-8>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>GM_notification(<span style=color:#d14>&#34;Hello!&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GM.notification({
</span></span><span style=display:flex><span>  text<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#39;This is a message with callback&#39;</span>,
</span></span><span style=display:flex><span>  onclick<span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>function</span>() {
</span></span><span style=display:flex><span>    alert(<span style=color:#d14>&#34;you click message ok button&#34;</span>);
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  ondone<span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>function</span>() {
</span></span><span style=display:flex><span>    alert(<span style=color:#d14>&#34;message bar closed&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GM_notification(<span style=color:#d14>&#34;Hello&#34;</span>,<span style=color:#d14>&#34;&#34;</span>,<span style=color:#d14>&#34;&#34;</span>,<span style=color:#000;font-weight:700>function</span>() {
</span></span><span style=display:flex><span>  alert(<span style=color:#d14>&#34;you click message ok button&#34;</span>);
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><h3 id=gm_setclipboard>GM_setClipboard</h3><h4 id=描述-9>描述</h4><p>写入字符串数据到剪贴板</p><h4 id=语法-9>语法</h4><pre tabindex=0><code>function GM_setClipboard(data)
</code></pre><h4 id=参数-8>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>data</td><td>字符串</td><td>字符串内容</td></tr></tbody></table><h4 id=示例-9>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>GM_setClipboard(<span style=color:#d14>&#39;this is test data&#39;</span>);
</span></span></code></pre></div><h3 id=gm_registermenucommand>GM_registerMenuCommand</h3><h4 id=描述-10>描述</h4><p>注册一个菜单选项，菜单选项会显示在X浏览器的页面工具菜单中。</p><h4 id=语法-10>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>	<span style=color:#000;font-weight:700>function</span> GM_registerMenuCommand(title,callback) 
</span></span></code></pre></div><h4 id=参数-9>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>title</td><td>字符串</td><td>菜单名称</td></tr><tr><td>callback</td><td>回调函数</td><td>点击菜单项执行的回调函数</td></tr></tbody></table><h4 id=返回值-2>返回值</h4><p>返回菜单项的命令ID, 注销菜单的时候会用到</p><h4 id=示例-10>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>GM_registerMenuCommand(<span style=color:#d14>&#34;click me&#34;</span>,<span style=color:#000;font-weight:700>function</span>() {
</span></span><span style=display:flex><span>	alert(<span style=color:#d14>&#34;You click menu item&#34;</span>);
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=gm_unregistermenucommand>GM_unregisterMenuCommand</h3><h4 id=描述-11>描述</h4><p>注销之前注册的菜单项</p><h4 id=语法-11>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_unregisterMenuCommand(commandId) 
</span></span></code></pre></div><h4 id=参数-10>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>commandId</td><td>字符串</td><td>菜单项的命令id</td></tr></tbody></table><h4 id=示例-11>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>GM_unregisterMenuCommand(commandId);
</span></span></code></pre></div><h3 id=gm_openintab>GM_openInTab</h3><h4 id=描述-12>描述</h4><p>在新标签中打开一个页面</p><h4 id=语法-12>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_openInTab(url,background) 
</span></span></code></pre></div><h4 id=参数-11>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>url</td><td>字符串</td><td>新标签页面的网址</td></tr><tr><td>background</td><td>布尔类型</td><td>是否在后台打开标签,默认为false</td></tr></tbody></table><h4 id=示例-12>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>GM_openInTab(<span style=color:#d14>&#34;https://www.example.com&#34;</span>);
</span></span><span style=display:flex><span>GM_openInTab(<span style=color:#d14>&#34;https://www.example.com&#34;</span>,<span style=color:#000;font-weight:700>true</span>);
</span></span></code></pre></div><h3 id=gm_download>GM_download</h3><h4 id=描述-13>描述</h4><p>调用浏览器的默认下载器进行下载</p><h4 id=语法-13>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_download(url,name) 
</span></span></code></pre></div><p>或者</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_download(detail) 
</span></span></code></pre></div><h4 id=参数-12>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>url</td><td>字符串</td><td>要下载资源的网址</td></tr><tr><td>name</td><td>字符串</td><td>下载文件保存的名称</td></tr><tr><td>detail</td><td>对象</td><td>通过对象配置下载参数</td></tr></tbody></table><h5 id=detail-参数属性列表>detail 参数属性列表</h5><ul><li><strong>url</strong> - 字符串类型，表示要下载的网址</li><li><strong>name</strong> - 字符串类型，下载文件保存的名称</li><li><strong>confirm</strong> - 布尔类型 ，是否弹出下载对话框，批量下载的时候设置此选项为false</li><li><strong>tag</strong> - 字符串 ,下载文件打上标签，X浏览器的实现是相同的标签的资源保存在以标签命名的目录。</li></ul><h4 id=示例-13>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>GM_download(<span style=color:#d14>&#34;https://www.xbext.com/download/xbrowser-release.apk&#34;</span>) 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#998;font-style:italic>//指定下载保存文件名称
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic></span>GM_download(<span style=color:#d14>&#34;https://www.xbext.com/download/xbrowser-release.apk,&#34;</span>xbrowser.apk<span style=color:#a61717;background-color:#e3d2d2>&#34;</span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#998;font-style:italic>//批量下载，保存在默认下载目录，名字为tag的子目录
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic></span><span style=color:#000;font-weight:700>let</span> urls <span style=color:#000;font-weight:700>=</span> [<span style=color:#d14>&#34;https://www.dundeecity.gov.uk/sites/default/files/publications/civic_renewal_forms.zip&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#d14>&#34;https://www.dundeecity.gov.uk/sites/default/files/publications/civic_renewal_forms.zip&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#d14>&#34;https://www.dundeecity.gov.uk/sites/default/files/publications/civic_renewal_forms.zip&#34;</span>,
</span></span><span style=display:flex><span>           ];
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>var</span> i <span style=color:#000;font-weight:700>=</span><span style=color:#099>0</span>;
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>for</span>(<span style=color:#000;font-weight:700>let</span> url <span style=color:#000;font-weight:700>of</span> urls ) {
</span></span><span style=display:flex><span>  GM_download({
</span></span><span style=display:flex><span>    url<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>`</span><span style=color:#d14>${</span>url<span style=color:#d14>}</span><span style=color:#d14>`</span>,
</span></span><span style=display:flex><span>    name<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>`test-file</span><span style=color:#d14>${</span><span style=color:#000;font-weight:700>++</span>i<span style=color:#d14>}</span><span style=color:#d14>.zip`</span>,
</span></span><span style=display:flex><span>    confirm<span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>false</span>,
</span></span><span style=display:flex><span>    tag<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#34;test-file&#34;</span>
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=gm_getresourcetext>GM_getResourceText</h3><h4 id=描述-14>描述</h4><p>获取元数据标记@resource指向资源的文本内容。</p><h4 id=语法-14>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_getResourceText(name)
</span></span></code></pre></div><h4 id=参数-13>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>name</td><td>字符串</td><td>标记@resource 定义的用于引用资源的键值名称</td></tr></tbody></table><h4 id=示例-14>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#998;font-style:italic>// @resource     main-content https://www.example.com/res/main-content.txt
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic></span><span style=color:#000;font-weight:700>var</span> text <span style=color:#000;font-weight:700>=</span> GM_getResourceText(<span style=color:#d14>&#34;main-content&#34;</span>);
</span></span></code></pre></div><h4 id=返回值-3>返回值</h4><p>返回资源URL的文本内容。</p><h3 id=gm_getresourceurl>GM_getResourceURL</h3><h4 id=描述-15>描述</h4><p>获取元数据标记@resource 指向资源的内容， 内容以Base64编码，格式为Data URI格式。</p><h4 id=语法-15>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_getResourceURL(name)
</span></span></code></pre></div><h4 id=参数-14>参数</h4><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>name</td><td>字符串</td><td>标记@resource 定义的用于引用资源的键值名称</td></tr></tbody></table><h4 id=示例-15>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span> <span style=color:#000;font-weight:700>var</span> img <span style=color:#000;font-weight:700>=</span> <span style=color:#0086b3>document</span>.querySelector(<span style=color:#d14>&#34;#avatar&#34;</span>)
</span></span><span style=display:flex><span> <span style=color:#998;font-style:italic>//@resource     avatar01 https://api.multiavatar.com/avatar01.svg
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic></span> img.src <span style=color:#000;font-weight:700>=</span> GM_getResourceURL(<span style=color:#d14>&#34;avatar01&#34;</span>);
</span></span></code></pre></div><h4 id=返回值-4>返回值</h4><p>返回以Base64编码的Data URI。</p><h3 id=gm_xmlhttprequest>GM_xmlhttpRequest</h3><h4 id=描述-16>描述</h4><p>这个方法类似于<a href=http://developer.mozilla.org/en/docs/XMLHttpRequest>XMLHttpRequest</a> 对象, 不同的是此方法支持跨域请求，突破了对象<a href=https://developer.mozilla.org/En/Same_origin_policy_for_JavaScript>同源访问策略</a>,使用起来更加灵活。</p><h4 id=语法-16>语法</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>function</span> GM_xmlhttpRequest(details)
</span></span></code></pre></div><h4 id=参数-15>参数</h4><p>这个方法只有对象类型的参数details ，对象的属性列表和含义如下：</p><table><thead><tr><th>名称</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>details</td><td>对象</td><td>包含一系列属性作为控制参数</td></tr></tbody></table><h5 id=details-属性说明>details 属性说明</h5><ul><li><strong>method</strong> - Http请求方法，GET、POST、HEAD等。</li><li><strong>url</strong> - 字符串，目标请求URL。</li><li><strong>headers</strong> - 可选项，字符串，HTTP协议头，User-Agent，Referer等。</li><li><strong>data</strong> - 可选项，字符串，通过POST方法发送的数据</li><li><strong>responseType</strong> - 可选项，字符串，设置响应类型，可以为arraybuffer, blob, json 和 stream 之一。</li><li><strong>onabort</strong>- 可选项，回调函数，当HTTP请求被终止时调用。</li><li><strong>onerror</strong>- 可选项，回调函数，HTTP请求出现异常时被调用</li><li><strong>onloadstart</strong> - 可选项，回调函数，HTTP请求开始被调用</li><li><strong>onreadystatechange</strong> - 可选项，回调函数，HTTP请求状态变化被调用</li><li><strong>onload</strong> - 可选项，回调函数，当HTTP请求完成时被调用，回调函数参数携带的几个属性如下<ul><li><strong>finalUrl</strong> - HTTP 最终请求的URL地址，比如最后重定向的网址。</li><li><strong>readyState</strong> - 数据状态</li><li><strong>status</strong> - HTTP请求状态</li><li><strong>statusText</strong> - HTTP请求状态文本</li><li><strong>responseHeaders</strong> - HTTP响应头</li><li><strong>response</strong> - HTTP响应返回的对象类型数据，当 <em>details.responseType</em> 被设置返回相应类型的对象。</li><li><strong>responseText</strong> - 返回文本类型的数据</li></ul></li></ul><h4 id=示例-16>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#998;font-style:italic>//发起一个get请求
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic></span>GM_xmlhttpRequest({
</span></span><span style=display:flex><span>  method<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#34;GET&#34;</span>,
</span></span><span style=display:flex><span>  url<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#34;http://www.example.com/&#34;</span>,
</span></span><span style=display:flex><span>  onload<span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>function</span>(response) {
</span></span><span style=display:flex><span>    alert(response.responseText);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#998;font-style:italic>//发起一个post请求
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic></span>GM.xmlHttpRequest({
</span></span><span style=display:flex><span>  method<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#34;POST&#34;</span>,
</span></span><span style=display:flex><span>  url<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#34;https://www.example.net/login&#34;</span>,
</span></span><span style=display:flex><span>  data<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#34;username=johndoe&amp;password=xyz123&#34;</span>,
</span></span><span style=display:flex><span>  headers<span style=color:#000;font-weight:700>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;Content-Type&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#34;application/x-www-form-urlencoded&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  onload<span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>function</span>(response) {
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>if</span> (response.responseText.indexOf(<span style=color:#d14>&#34;Logged in as&#34;</span>) <span style=color:#000;font-weight:700>&gt;</span> <span style=color:#000;font-weight:700>-</span><span style=color:#099>1</span>) {
</span></span><span style=display:flex><span>      location.href <span style=color:#000;font-weight:700>=</span> <span style=color:#d14>&#34;http://www.example.net/dashboard&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=gm_info>GM_info</h3><p>这是一个对象，用来保存每个脚本的相关环境变量，比如脚本的版本、作者、介绍等，对象属性列表如下：</p><ul><li><p><strong>script</strong> - 对象类型，包含下面一些属性。</p><ul><li><strong>author</strong> - 脚本作者</li><li><strong>name</strong> - 脚本名称</li><li><strong>description</strong> - 脚本介绍</li><li><strong>version</strong> - 版本</li><li><strong>copyright</strong> - 版权信息</li><li><strong>includes</strong> - 数组类型，包含匹配页面的列表</li><li><strong>matches</strong> - 数组类型，和includes类似，包含匹配页面的列表</li><li><strong>excludes</strong> -数组类型，排除匹配网址列表</li><li><strong>resources</strong> - 数组类型，所有资源列表</li></ul></li><li><p><strong>version</strong> - 脚本管理器的版本</p></li><li><p><strong>scriptHandler</strong> - 脚本管理器的名称</p></li><li><p><strong>scriptMetaStr</strong> - 脚本管理器元数据字符串</p></li></ul><h4 id=示例-17>示例</h4><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#000;font-weight:700>var</span> info <span style=color:#000;font-weight:700>=</span> <span style=color:#d14>&#34;Script Name: &#34;</span>  <span style=color:#000;font-weight:700>+</span> GM_info.script.name <span style=color:#000;font-weight:700>+</span> 
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;\nVersion: &#34;</span> <span style=color:#000;font-weight:700>+</span> GM_info.script.version <span style=color:#000;font-weight:700>+</span> 
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;\nVersion: &#34;</span> <span style=color:#000;font-weight:700>+</span> GM_info.script.version <span style=color:#000;font-weight:700>+</span> 
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;\nScriptHandler: &#34;</span> <span style=color:#000;font-weight:700>+</span> GM_info.scriptHandler <span style=color:#000;font-weight:700>+</span> 
</span></span><span style=display:flex><span>    <span style=color:#d14>&#34;\nScript Handler Version : &#34;</span> <span style=color:#000;font-weight:700>+</span> GM_info.version ;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>alert(info);
</span></span></code></pre></div><h2 id=参考资料>参考资料</h2><ul><li><p><a href=https://www.tampermonkey.net/documentation.php>https://www.tampermonkey.net/documentation.php</a></p></li><li><p><a href=https://wiki.greasespot.net/Greasemonkey_Manual:API>https://wiki.greasespot.net/Greasemonkey_Manual:API</a></p></li></ul></div><div class=container-prevnext><div></div><div><a href=https://huaii.top/archive/>Archive →</a></div></div><div class=container-comment><script src=https://utteranc.es/client.js repo=loveminimal/comment issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div></div><div id=footer><div class=container-footer><a href=//beian.miit.gov.cn target=_blank>豫ICP备2022002918号-1
</a><a id=s href=/secrets>&nbsp;</a></div></div></body></html>